# Sane default
setopt no_beep
setopt auto_cd
export HISTSIZE=1000000
export SAVEHIST=1000000
setopt append_history
setopt hist_ignore_all_dups
setopt hist_ignore_space
setopt share_history
setopt no_auto_remove_slash
autoload -U compinit && compinit

# Envvars
export SHELL=/usr/local/bin/zsh
export EDITOR='vim'
export VISUAL='code'
export PAGER='less'
export LANG=en_US.UTF-8
export LC_CTYPE=en_US.UTF-8
export PATH="/usr/local/bin:${HOME}/usr/local/bin:/usr/local/sbin:${PATH}"
export PATH="${PATH}:/usr/local/opt/go/libexec/bin"
export PATH="${HOME}/.cargo/bin:${PATH}"
export PGDATA="/usr/local/var/postgres"
export GOPATH="${HOME}/repos/gopher"
[ -n "$GOPATH" ] && export PATH="${PATH}:$(go env GOPATH)/bin"

# Minimal settings
source ${HOME}/.slimzsh/slim.zsh
source ${HOME}/.zsh-autosuggestions/zsh-autosuggestions.zsh
source ${HOME}/.zplug/init.zsh
unsetopt correct_all

# Packages
zplug "b4b4r07/emoji-cli"
zplug "zsh-users/zsh-syntax-highlighting", defer:2
zplug "zsh-users/zsh-completions"

# Install plugins if there are plugins that have not been installed
if ! zplug check --verbose; then
    printf "Install? [y/N]: "
    if read -q; then
        echo; zplug install
    fi
fi

# Then, source plugins and add commands to $PATH
zplug load

# Theming
[ -f "${HOME}/.nord.dircolors" ] && eval $(gdircolors -b ${HOME}/.nord.dircolors)
[ -n "$LS_COLORS" ] && zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}

# Aliases
alias ls='gls --color=auto'
alias ll='ls -lh'
alias la='ls -alh'
alias chrome="/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome"

# Keys, Completions
bindkey -e
bindkey "\e[Z" reverse-menu-complete
bindkey -a 'q' push-line
bindkey -a 'H' run-help
bindkey "^F" forward-char
bindkey "^B" backward-char
autoload history-search-end
zle -N history-beginning-search-backward-end history-search-end
zle -N history-beginning-search-forward-end history-search-end
bindkey "^P" history-beginning-search-backward-end
bindkey "^N" history-beginning-search-forward-end

_google_cloud_sdk_dir="${HOME}/google-cloud-sdk/"
[ -f "${_google_cloud_sdk_dir}path.zsh.inc" ] && source "${_google_cloud_sdk_dir}path.zsh.inc"
[ -f "${_google_cloud_sdk_dir}completion.zsh.inc" ] && source "${_google_cloud_sdk_dir}completion.zsh.inc"

[ -d "${HOME}/.pyenv" ] && eval "$(pyenv init -)"
[ -f "${HOME}/.fzf.zsh" ] && . ~/.fzf.zsh
[ -d "${HOME}/.poetry" ] && export PATH="${PATH}:${HOME}/.poetry/bin"
